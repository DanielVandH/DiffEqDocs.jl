<!DOCTYPE html><HTML lang="en"><head><meta charset="utf-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Chemical Reaction Models Â· DifferentialEquations.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="https://docs.juliadiffeq.org/stable/models/biological/index.html" rel="canonical"/><script data-is-old-version="">document.addEventListener("DOMContentLoaded", function(){
    const div = document.createElement('div');
    div.setAttribute('style', 'position: fixed; bottom: 1em; right: 1em; z-index: 999; background-color: #ffaf9c; color: rgba(0, 0, 0, 0.7); border: 1px solid #d54625; border-radius: 4px; padding: 2em; text-align: center');
    const closer = document.createElement('div');
    closer.setAttribute('style', 'position: absolute; top: 0; right: 5px; padding: 5px; cursor: pointer; width: 12px; height: 12px;')
    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', () => {
        document.body.removeChild(div)
    })
    const href = documenterBaseURL + '/../stable'
    div.innerHTML = 'This is an old version of the documentation. <br> Click <a href="' + href + '">here</a> to go to the newest version.';
    div.appendChild(closer)
    document.body.appendChild(div);
});
</script><script data-outdated-warner="">function maybeAddWarning () {
    const head = document.getElementsByTagName('head')[0];

    // Add a noindex meta tag (unless one exists) so that search engines don't index this version of the docs.
    if (document.body.querySelector('meta[name="robots"]') === null) {
        const meta = document.createElement('meta');
        meta.name = 'robots';
        meta.content = 'noindex';

        head.appendChild(meta);
    };

    // Add a stylesheet to avoid inline styling
    const style = document.createElement('style');
    style.type = 'text/css';
    style.appendChild(document.createTextNode('.outdated-warning-overlay {  position: fixed;  top: 0;  left: 0;  right: 0;  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);  z-index: 999;  background-color: #ffaba7;  color: rgba(0, 0, 0, 0.7);  border-bottom: 3px solid #da0b00;  padding: 10px 35px;  text-align: center;  font-size: 15px; }  .outdated-warning-overlay .outdated-warning-closer {    position: absolute;    top: calc(50% - 10px);    right: 18px;    cursor: pointer;    width: 12px; }  .outdated-warning-overlay a {    color: #2e63b8; }    .outdated-warning-overlay a:hover {      color: #363636; }'));
    head.appendChild(style);

    const div = document.createElement('div');
    div.classList.add('outdated-warning-overlay');
    const closer = document.createElement('div');
    closer.classList.add('outdated-warning-closer');

    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', function () {
        document.body.removeChild(div);
    });
    let href = '/stable';
    if (window.documenterBaseURL) {
        href = window.documenterBaseURL + '/../stable';
    }
    div.innerHTML = 'This is an old version of the documentation. <br> <a href="' + href + '">Go to the newest version</a>.';
    div.appendChild(closer);
    document.body.appendChild(div);
};

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', maybeAddWarning);
} else {
    maybeAddWarning();
};
</script></head><body><nav class="toc"><a href="../index.html"><img alt="DifferentialEquations.jl logo" class="logo" src="../assets/logo.png"/></a><h1>DifferentialEquations.jl</h1><select id="version-selector" onchange="window.location.href=this.value" style="visibility: hidden"></select><form action="../search.html" class="search" id="search-form"><input id="search-query" name="q" placeholder="Search docs" type="text"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="../tutorials/ode_example.html">Ordinary Differential Equations</a></li><li><a class="toctext" href="../tutorials/sde_example.html">Stochastic Differential Equations</a></li><li><a class="toctext" href="../tutorials/rode_example.html">Random Ordinary Differential Equations</a></li><li><a class="toctext" href="../tutorials/dde_example.html">Delay Differential Equations</a></li><li><a class="toctext" href="../tutorials/dae_example.html">Differential Algebraic Equations</a></li><li><a class="toctext" href="../tutorials/discrete_stochastic_example.html">Discrete Stochastic (Gillespie) Equations</a></li><li><a class="toctext" href="../tutorials/jump_diffusion.html">Jump Diffusion Equations</a></li><li><a class="toctext" href="../tutorials/bvp_example.html">Boundary Value Problems</a></li><li><a class="toctext" href="../tutorials/additional.html">Additional Tutorials</a></li></ul></li><li><span class="toctext">Basics</span><ul><li><a class="toctext" href="../basics/overview.html">Overview of DifferentialEquations.jl</a></li><li><a class="toctext" href="../basics/common_solver_opts.html">Common Solver Options</a></li><li><a class="toctext" href="../basics/solution.html">Solution Handling</a></li><li><a class="toctext" href="../basics/plot.html">Plot Functions</a></li><li><a class="toctext" href="../basics/integrator.html">Integrator Interface</a></li><li><a class="toctext" href="../basics/problem.html">Problem interface</a></li><li><a class="toctext" href="../basics/faq.html">Frequently Asked Questions</a></li><li><a class="toctext" href="../basics/compatibility_chart.html">Solver Compatibility Chart</a></li></ul></li><li><span class="toctext">Problem Types</span><ul><li><a class="toctext" href="../types/discrete_types.html">Discrete Problems</a></li><li><a class="toctext" href="../types/ode_types.html">ODE Problems</a></li><li><a class="toctext" href="../types/dynamical_types.html">Dynamical, Hamiltonian and 2nd Order ODE Problems</a></li><li><a class="toctext" href="../types/split_ode_types.html">Split ODE Problems</a></li><li><a class="toctext" href="../types/steady_state_types.html">Steady State Problems</a></li><li><a class="toctext" href="../types/bvp_types.html">BVP Problems</a></li><li><a class="toctext" href="../types/sde_types.html">SDE Problems</a></li><li><a class="toctext" href="../types/rode_types.html">RODE Problems</a></li><li><a class="toctext" href="../types/dde_types.html">DDE Problems</a></li><li><a class="toctext" href="../types/dae_types.html">DAE Problems</a></li><li><a class="toctext" href="../types/jump_types.html">Jump Problems</a></li></ul></li><li><span class="toctext">Solver Algorithms</span><ul><li><a class="toctext" href="../solvers/discrete_solve.html">Discrete Solvers</a></li><li><a class="toctext" href="../solvers/ode_solve.html">ODE Solvers</a></li><li><a class="toctext" href="../solvers/dynamical_solve.html">Dynamical, Hamiltonian, and 2nd Order ODE Solvers</a></li><li><a class="toctext" href="../solvers/split_ode_solve.html">Split ODE Solvers</a></li><li><a class="toctext" href="../solvers/steady_state_solve.html">Steady State Solvers</a></li><li><a class="toctext" href="../solvers/bvp_solve.html">BVP Solvers</a></li><li><a class="toctext" href="../solvers/jump_solve.html">Jump Problem Solvers</a></li><li><a class="toctext" href="../solvers/sde_solve.html">SDE Solvers</a></li><li><a class="toctext" href="../solvers/rode_solve.html">RODE Solvers</a></li><li><a class="toctext" href="../solvers/dde_solve.html">DDE Solvers</a></li><li><a class="toctext" href="../solvers/dae_solve.html">DAE Solvers</a></li><li><a class="toctext" href="../solvers/benchmarks.html">Solver Benchmarks</a></li></ul></li><li><span class="toctext">Additional Features</span><ul><li><a class="toctext" href="../features/performance_overloads.html">Performance Overloads</a></li><li><a class="toctext" href="../features/diffeq_arrays.html">DiffEq-Specific Array Types</a></li><li><a class="toctext" href="../features/diffeq_operator.html">DiffEqOperators</a></li><li><a class="toctext" href="../features/noise_process.html">Noise Processes</a></li><li><a class="toctext" href="../features/linear_nonlinear.html">Specifying (Non)Linear Solvers</a></li><li><a class="toctext" href="../features/callback_functions.html">Event Handling and Callback Functions</a></li><li><a class="toctext" href="../features/callback_library.html">Callback Library</a></li><li><a class="toctext" href="../features/monte_carlo.html">Parallel Monte Carlo Simulations</a></li><li><a class="toctext" href="../features/io.html">I/O: Saving and Loading Solution Data</a></li><li><a class="toctext" href="../features/low_dep.html">Low Dependency Usage</a></li><li><a class="toctext" href="../features/progress_bar.html">Juno Progress Bar Integration</a></li></ul></li><li><span class="toctext">Analysis Tools</span><ul><li><a class="toctext" href="../analysis/parameterized_functions.html">ParameterizedFunctions</a></li><li><a class="toctext" href="../analysis/parameter_estimation.html">Parameter Estimation</a></li><li><a class="toctext" href="../analysis/bifurcation.html">Bifurcation Analysis</a></li><li><a class="toctext" href="../analysis/sensitivity.html">Sensitivity Analysis</a></li><li><a class="toctext" href="../analysis/uncertainty_quantification.html">Uncertainty Quantification</a></li><li><a class="toctext" href="../analysis/dev_and_test.html">Algorithm Development and Testing</a></li></ul></li><li><span class="toctext">Domain Modeling Tools</span><ul><li><a class="toctext" href="multiscale.html">Multi-Scale Models</a></li><li><a class="toctext" href="physical.html">Physical Models</a></li><li><a class="toctext" href="financial.html">Financial Models</a></li><li class="current"><a class="toctext" href="biological.html">Chemical Reaction Models</a><ul class="internal"><li><a class="toctext" href="#The-Reaction-DSL-1">The Reaction DSL</a></li></ul></li><li><a class="toctext" href="external_modeling.html">External Modeling Packages</a></li></ul></li><li><span class="toctext">Extra Details</span><ul><li><a class="toctext" href="../extras/timestepping.html">Timestepping Method Descriptions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Domain Modeling Tools</li><li><a href="biological.html">Chemical Reaction Models</a></li></ul><a class="edit-page" href="https://github.com/JuliaDiffEq/DiffEqDocs.jl/blob/master/docs/src/models/biological.md"><span class="fa">ï</span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Chemical Reaction Models</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" href="#Chemical-Reaction-Models-1" id="Chemical-Reaction-Models-1">Chemical Reaction Models</a></h1><p>The biological models functionality is provided by DiffEqBiological.jl and helps the user build discrete stochastic and differential equation based systems biological models. These tools allow one to define the models at a high level by specifying reactions and rate constants, and the creation of the actual problems is then handled by the modeling package.</p><h2><a class="nav-anchor" href="#The-Reaction-DSL-1" id="The-Reaction-DSL-1">The Reaction DSL</a></h2><p>The <code>@reaction_network</code> DSL allows you to define reaction networks in a more scientific format. Its input is a set of chemical reactions and from them it generates a reaction network object which can be used as input to <code>ODEProblem</code>, <code>SDEProblem</code> and <code>JumpProblem</code> constructors.</p><p>The basic syntax is:</p><pre><code class="language-julia">rn = @reaction_network rType begin
  2.0, X + Y --&gt; XY               
  1.0, XY --&gt; Z            
end</code></pre><p>where each line corresponds to a chemical reaction. The input <code>rType</code> designates the type of this instance (all instances will inherit from the abstract type <code>AbstractReactionNetwork</code>).</p><p>The DSL can handle several types of arrows, in both backwards and forward direction. If a bi-directional arrow is used two reaction rates must be designated. These two reaction networks are identical:</p><pre><code class="language-julia">rn1 = @reaction_network rType begin
  2.0, X + Y â XY               
  1.0, XY &gt; Z       
  1.0, X + Y â XY               
  0.5, XY &lt; Z           
end
rn1 = @reaction_network rType begin
  (2.0,1.0), X + Y â XY               
  (1.0, 0.5), XY â· Z       
end</code></pre><p>The empty set can be used for production or degradation and is declared using either <code>0</code> or <code>â</code>. Integers denote the number of each reactant partaking in the reaction.</p><pre><code class="language-julia">rn1 = @reaction_network rType begin
  2.0, 2X --&gt; 0        
  2.0, â --&gt; X  
end</code></pre><p>Multiple reactions can be declared in a single line:</p><pre><code class="language-julia">rn = @reaction_network rType begin
  2.0, (X,Y) --&gt; 0                   #Identical to reactions [2.0, X --&gt; 0] and [2.0, Y --&gt; 0]
  (2.0, 1.0), (X,Y) --&gt; 0            #Identical to reactions [2.0, X --&gt; 0] and [1.0, X --&gt; 0]
  2.0, (X1,Y1) --&gt; (X2,Y2)           #Identical to reactions [2.0, X1 --&gt; X2] and [2.0, Y1 --&gt; Y2]
  (2.0,1.0), X + Y â XY              #Identical to reactions [2.0, X + Y --&gt; XY] and [1.0, XY --&gt; X + Y].
  ((2.0,1.0),(1.0,2.0)), (X,Y) â 0   #Identical to reactions [(2.0,1.0), X â 0] and [(1.0,2.0), Y â 0].
end</code></pre><p>Parameters can be added to the network by declaring them after the reaction network. Parameters can only exist in the reaction rate and not as a part of the reaction.</p><pre><code class="language-julia">rn = @reaction_network rType begin
    (kB, kD), X + Y â XY
end kB kD
p = [2.0, 1.0]</code></pre><p>The parameter set <code>p</code> must be passed to the problem constructor. The parameter values can be changed after the reaction network is defined.</p><p>The reaction rate do not need to be constant, but maybe depend on the concentration of the reactants.</p><pre><code class="language-julia">rn = @reaction_network rType begin
    (1.0,2XY), X + Y â XY
end</code></pre><p>The hill function <code>hill(x,v,K,n) = v*(x^n)/(x^n + K^n)</code> can be used, as well as the Michaelis Menten function (the hill function with <code>n = 1</code>).</p><pre><code class="language-julia">rn = @reaction_network rType begin
    (1.0,hill(XY,1.5,2.0,2)), X + Y â XY
end</code></pre><p>By using the <code>@reaction_func</code> macro it is possible to define your own functions, which may then be used when creating new reaction networks.</p><pre><code class="language-julia">@reaction_func hill2(x, v, k) = v*x^2/(k^2+x^2)    
rn = @reaction_network rType begin
  (1.0,hill2(XY,1.5,2.0)), X + Y â XY
end</code></pre><p>Reaction rates are automatically adjusted according mass kinetics, including taking special account of higher order terms like <code>2X --&gt;</code>. This can be disabled using any non-filled arrow (<code>â, â½, â, â¾, â, âº</code>), in which case the reaction rate will be exactly as input. E.g the two reactions in</p><pre><code class="language-julia">rn = @reaction_network rType begin
    2.0, X + Y --&gt; XY
    2.0*X*Y, X + Y â¾ XY
end</code></pre><p>will both have reaction rate equal to <code>2[X][Y]</code>.</p><p>Once a reaction network has been created it can be passed as input to either one of the <code>ODEProblem</code>, <code>SDEProblem</code> or <code>JumpProblem</code> constructors.</p><pre><code class="language-julia">  probODE = ODEProblem(rn, args...; kwargs...)      
  probSDE = SDEProblem(rn, args...; kwargs...)
  probJump = JumpProblem(prob,aggregator::Direct,rn)</code></pre><p>the output problems may then be used as normal input to the solvers of the <code>DifferentialEquations</code> package.</p><p>The noise used by the SDEProblem will correspond to the Chemical Langevin Equations. However it is possible to scale the amount of noise be declaring a noise parameter. This will be done after declaring the type but before the network.</p><pre><code class="language-julia">rn = @reaction_network BiDir begin
    2.0, X + Y â XY
end
p = [0.5]</code></pre><p>The noise term is then added as an additional parameter to the network (by default the last parameter in the parameter array, unless also declared after the reaction network among the other parameters). By reducing (or increasing) the noise term the amount stochastic fluctuations in the system can be reduced (or increased).</p><p>It is possible to access expressions corresponding to the functions determining the deterministic and stochastic development of the network using.</p><pre><code class="language-julia">  f_expr = rn.f_func
  g_expr = rn.g_func</code></pre><p>This can e.g. be used to generate LaTeX code corresponding to the system.</p><h3><a class="nav-anchor" href="#Example:-Birth-Death-Process-1" id="Example:-Birth-Death-Process-1">Example: Birth-Death Process</a></h3><pre><code class="language-julia">rs = @reaction_network begin
  c1, X --&gt; 2X
  c2, X --&gt; 0
  c3, 0 --&gt; X
end c1 c2 c3
p = (2.0,1.0,0.5)
prob = DiscreteProblem([5], (0.0, 4.0), p)
jump_prob = JumpProblem(prob, Direct(), rs)
sol = solve(jump_prob, Discrete())</code></pre><h3><a class="nav-anchor" href="#Example:-Michaelis-Menten-Enzyme-Kinetics-1" id="Example:-Michaelis-Menten-Enzyme-Kinetics-1">Example: Michaelis-Menten Enzyme Kinetics</a></h3><pre><code class="language-julia">rs = @reaction_network begin
  c1, S + E --&gt; SE
  c2, SE --&gt; S + E
  c3, SE --&gt; P + E
end c1 c2 c3
p = (0.00166,0.0001,0.1)
# S = 301, E = 100, SE = 0, P = 0
prob = DiscreteProblem([301, 100, 0, 0], (0.0, 100.0), p)
jump_prob = JumpProblem(prob, Direct(), rs)
sol = solve(jump_prob, Discrete())</code></pre><footer><hr/><a class="previous" href="financial.html"><span class="direction">Previous</span><span class="title">Financial Models</span></a><a class="next" href="external_modeling.html"><span class="direction">Next</span><span class="title">External Modeling Packages</span></a></footer></article></body></HTML>