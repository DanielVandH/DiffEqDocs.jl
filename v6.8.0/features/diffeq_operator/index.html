<!DOCTYPE html><HTML lang="en"><head><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>DiffEqOperators Â· DifferentialEquations.jl</title><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-90474609-3', 'auto');
ga('send', 'pageview');
</script><link href="https://docs.juliadiffeq.org/stable/features/diffeq_operator/index.html" rel="canonical"/><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script data-main="../../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><script data-is-old-version="">document.addEventListener("DOMContentLoaded", function(){
    const div = document.createElement('div');
    div.setAttribute('style', 'position: fixed; bottom: 1em; right: 1em; z-index: 999; background-color: #ffaf9c; color: rgba(0, 0, 0, 0.7); border: 1px solid #d54625; border-radius: 4px; padding: 2em; text-align: center');
    const closer = document.createElement('div');
    closer.setAttribute('style', 'position: absolute; top: 0; right: 5px; padding: 5px; cursor: pointer; width: 12px; height: 12px;')
    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', () => {
        document.body.removeChild(div)
    })
    const href = documenterBaseURL + '/../stable'
    div.innerHTML = 'This is an old version of the documentation. <br> Click <a href="' + href + '">here</a> to go to the newest version.';
    div.appendChild(closer)
    document.body.appendChild(div);
});
</script><script data-outdated-warner="">function maybeAddWarning () {
    const head = document.getElementsByTagName('head')[0];

    // Add a noindex meta tag (unless one exists) so that search engines don't index this version of the docs.
    if (document.body.querySelector('meta[name="robots"]') === null) {
        const meta = document.createElement('meta');
        meta.name = 'robots';
        meta.content = 'noindex';

        head.appendChild(meta);
    };

    // Add a stylesheet to avoid inline styling
    const style = document.createElement('style');
    style.type = 'text/css';
    style.appendChild(document.createTextNode('.outdated-warning-overlay {  position: fixed;  top: 0;  left: 0;  right: 0;  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);  z-index: 999;  background-color: #ffaba7;  color: rgba(0, 0, 0, 0.7);  border-bottom: 3px solid #da0b00;  padding: 10px 35px;  text-align: center;  font-size: 15px; }  .outdated-warning-overlay .outdated-warning-closer {    position: absolute;    top: calc(50% - 10px);    right: 18px;    cursor: pointer;    width: 12px; }  .outdated-warning-overlay a {    color: #2e63b8; }    .outdated-warning-overlay a:hover {      color: #363636; }'));
    head.appendChild(style);

    const div = document.createElement('div');
    div.classList.add('outdated-warning-overlay');
    const closer = document.createElement('div');
    closer.classList.add('outdated-warning-closer');

    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', function () {
        document.body.removeChild(div);
    });
    let href = '/stable';
    if (window.documenterBaseURL) {
        href = window.documenterBaseURL + '/../stable';
    }
    div.innerHTML = 'This is an old version of the documentation. <br> <a href="' + href + '">Go to the newest version</a>.';
    div.appendChild(closer);
    document.body.appendChild(div);
};

if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', maybeAddWarning);
} else {
    maybeAddWarning();
};
</script></head><body><nav class="toc"><a href="../../"><img alt="DifferentialEquations.jl logo" class="logo" src="../../assets/logo.png"/></a><h1>DifferentialEquations.jl</h1><select id="version-selector" onchange="window.location.href=this.value" style="visibility: hidden"></select><form action="../../search/" class="search" id="search-form"><input id="search-query" name="q" placeholder="Search docs" type="text"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Tutorials</span><ul><li><a class="toctext" href="../../tutorials/ode_example/">Ordinary Differential Equations</a></li><li><a class="toctext" href="../../tutorials/advanced_ode_example/">Solving Stiff Equations</a></li><li><a class="toctext" href="../../tutorials/sde_example/">Stochastic Differential Equations</a></li><li><a class="toctext" href="../../tutorials/rode_example/">Random Ordinary Differential Equations</a></li><li><a class="toctext" href="../../tutorials/dde_example/">Delay Differential Equations</a></li><li><a class="toctext" href="../../tutorials/dae_example/">Differential Algebraic Equations</a></li><li><a class="toctext" href="../../tutorials/discrete_stochastic_example/">Discrete Stochastic (Gillespie) Equations</a></li><li><a class="toctext" href="../../tutorials/jump_diffusion/">Jump Diffusion Equations</a></li><li><a class="toctext" href="../../tutorials/bvp_example/">Boundary Value Problems</a></li><li><a class="toctext" href="../../tutorials/additional/">Additional Tutorials</a></li></ul></li><li><span class="toctext">Basics</span><ul><li><a class="toctext" href="../../basics/overview/">Overview of DifferentialEquations.jl</a></li><li><a class="toctext" href="../../basics/common_solver_opts/">Common Solver Options</a></li><li><a class="toctext" href="../../basics/solution/">Solution Handling</a></li><li><a class="toctext" href="../../basics/plot/">Plot Functions</a></li><li><a class="toctext" href="../../basics/integrator/">Integrator Interface</a></li><li><a class="toctext" href="../../basics/problem/">Problem Interface</a></li><li><a class="toctext" href="../../basics/faq/">Frequently Asked Questions</a></li><li><a class="toctext" href="../../basics/compatibility_chart/">Solver Compatibility Chart</a></li></ul></li><li><span class="toctext">Problem Types</span><ul><li><a class="toctext" href="../../types/discrete_types/">Discrete Problems</a></li><li><a class="toctext" href="../../types/ode_types/">ODE Problems</a></li><li><a class="toctext" href="../../types/dynamical_types/">Dynamical, Hamiltonian and 2nd Order ODE Problems</a></li><li><a class="toctext" href="../../types/split_ode_types/">Split ODE Problems</a></li><li><a class="toctext" href="../../types/steady_state_types/">Steady State Problems</a></li><li><a class="toctext" href="../../types/bvp_types/">BVP Problems</a></li><li><a class="toctext" href="../../types/sde_types/">SDE Problems</a></li><li><a class="toctext" href="../../types/rode_types/">RODE Problems</a></li><li><a class="toctext" href="../../types/dde_types/">DDE Problems</a></li><li><a class="toctext" href="../../types/dae_types/">DAE Problems</a></li><li><a class="toctext" href="../../types/jump_types/">Jump Problems</a></li></ul></li><li><span class="toctext">Solver Algorithms</span><ul><li><a class="toctext" href="../../solvers/discrete_solve/">Discrete Solvers</a></li><li><a class="toctext" href="../../solvers/ode_solve/">ODE Solvers</a></li><li><a class="toctext" href="../../solvers/dynamical_solve/">Dynamical, Hamiltonian, and 2nd Order ODE Solvers</a></li><li><a class="toctext" href="../../solvers/split_ode_solve/">Split ODE Solvers</a></li><li><a class="toctext" href="../../solvers/steady_state_solve/">Steady State Solvers</a></li><li><a class="toctext" href="../../solvers/bvp_solve/">BVP Solvers</a></li><li><a class="toctext" href="../../solvers/jump_solve/">Jump Problem Solvers</a></li><li><a class="toctext" href="../../solvers/sde_solve/">SDE Solvers</a></li><li><a class="toctext" href="../../solvers/rode_solve/">RODE Solvers</a></li><li><a class="toctext" href="../../solvers/dde_solve/">DDE Solvers</a></li><li><a class="toctext" href="../../solvers/dae_solve/">DAE Solvers</a></li><li><a class="toctext" href="../../solvers/benchmarks/">Solver Benchmarks</a></li></ul></li><li><span class="toctext">Additional Features</span><ul><li><a class="toctext" href="../performance_overloads/">DiffEqFunctions (Jacobians, Gradients, etc.) and Jacobian Types</a></li><li><a class="toctext" href="../diffeq_arrays/">DiffEq-Specific Array Types</a></li><li class="current"><a class="toctext" href="">DiffEqOperators</a><ul class="internal"><li><a class="toctext" href="#Using-DiffEqOperators-1">Using DiffEqOperators</a></li><li><a class="toctext" href="#Constructors-1">Constructors</a></li><li><a class="toctext" href="#Formal-Properties-of-DiffEqOperators-1">Formal Properties of DiffEqOperators</a></li></ul></li><li><a class="toctext" href="../noise_process/">Noise Processes</a></li><li><a class="toctext" href="../linear_nonlinear/">Specifying (Non)Linear Solvers</a></li><li><a class="toctext" href="../callback_functions/">Event Handling and Callback Functions</a></li><li><a class="toctext" href="../callback_library/">Callback Library</a></li><li><a class="toctext" href="../ensemble/">Parallel Ensemble Simulations</a></li><li><a class="toctext" href="../io/">I/O: Saving and Loading Solution Data</a></li><li><a class="toctext" href="../low_dep/">Low Dependency Usage</a></li><li><a class="toctext" href="../progress_bar/">Juno Progress Bar Integration</a></li></ul></li><li><span class="toctext">Analysis Tools</span><ul><li><a class="toctext" href="../../analysis/parameterized_functions/">ParameterizedFunctions</a></li><li><a class="toctext" href="../../analysis/parameter_estimation/">Parameter Estimation and Bayesian Analysis</a></li><li><a class="toctext" href="../../analysis/bifurcation/">Bifurcation Analysis</a></li><li><a class="toctext" href="../../analysis/sensitivity/">Local Sensitivity Analysis (Automatic Differentiation)</a></li><li><a class="toctext" href="../../analysis/global_sensitivity/">Global Sensitivity Analysis</a></li><li><a class="toctext" href="../../analysis/uncertainty_quantification/">Uncertainty Quantification</a></li><li><a class="toctext" href="../../analysis/neural_networks/">Neural Networks</a></li><li><a class="toctext" href="../../analysis/dev_and_test/">Algorithm Development and Testing</a></li></ul></li><li><span class="toctext">Domain Modeling Tools</span><ul><li><a class="toctext" href="../../models/multiscale/">Multi-Scale Models</a></li><li><a class="toctext" href="../../models/physical/">Physical Models</a></li><li><a class="toctext" href="../../models/financial/">Financial Models</a></li><li><a class="toctext" href="../../models/biological/">Chemical Reaction Models</a></li><li><a class="toctext" href="../../models/external_modeling/">External Modeling Packages</a></li></ul></li><li><span class="toctext">APIs</span><ul><li><span class="toctext">DiffEqBase API</span><ul><li><a class="toctext" href="../../apis/diffeqbase/overview/">Overview</a></li><li><a class="toctext" href="../../apis/diffeqbase/functions/">DE functions</a></li><li><a class="toctext" href="../../apis/diffeqbase/problems/">Problems</a></li><li><a class="toctext" href="../../apis/diffeqbase/solutions/">Solutions</a></li><li><a class="toctext" href="../../apis/diffeqbase/solvers/">Solvers</a></li><li><a class="toctext" href="../../apis/diffeqbase/de_types/">DE types</a></li><li><a class="toctext" href="../../apis/diffeqbase/operators/">Operators</a></li><li><a class="toctext" href="../../apis/diffeqbase/callbacks/">Callbacks</a></li><li><a class="toctext" href="../../apis/diffeqbase/interpolation/">Interpolation</a></li><li><a class="toctext" href="../../apis/diffeqbase/ensembles/">Ensembles</a></li><li><a class="toctext" href="../../apis/diffeqbase/data_arrays/">Data arrays</a></li><li><a class="toctext" href="../../apis/diffeqbase/noise/">Noise processes</a></li><li><a class="toctext" href="../../apis/diffeqbase/utility/">Utility</a></li></ul></li><li><a class="toctext" href="../../apis/diffeqbio/">DiffEqBiological.jl API</a></li></ul></li><li><span class="toctext">Extra Details</span><ul><li><a class="toctext" href="../../extras/timestepping/">Timestepping Method Descriptions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Additional Features</li><li><a href="">DiffEqOperators</a></li></ul><a class="edit-page" href="https://github.com/JuliaDiffEq/DiffEqDocs.jl/blob/master/docs/src/features/diffeq_operator.md"><span class="fa">ï</span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>DiffEqOperators</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" href="#DiffEqOperators-1" id="DiffEqOperators-1">DiffEqOperators</a></h1><p>The <code>AbstractDiffEqOperator</code> interface is an interface for declaring parts of a differential equation as linear or affine. This then allows the solvers to exploit linearity to achieve maximal performance.</p><h3><a class="nav-anchor" href="#Note:-this-functionality-is-under-heavy-development.-Interfaces-may-change.-Treat-this-as-experimental-until-the-end-of-Summer-2019.-1" id="Note:-this-functionality-is-under-heavy-development.-Interfaces-may-change.-Treat-this-as-experimental-until-the-end-of-Summer-2019.-1">Note: this functionality is under heavy development. Interfaces may change. Treat this as experimental until the end of Summer 2019.</a></h3><h2><a class="nav-anchor" href="#Using-DiffEqOperators-1" id="Using-DiffEqOperators-1">Using DiffEqOperators</a></h2><p><code>AbstractDiffEqOperator</code>s act like functions. When defined, <code>A</code> has function calls <code>A(u,p,t)</code> and <code>A(du,u,p,t)</code> that act like <code>A*u</code>. These operators update via a function <code>update_coefficients!(A,u,p,t)</code>.</p><h2><a class="nav-anchor" href="#Constructors-1" id="Constructors-1">Constructors</a></h2><h3><a class="nav-anchor" href="#Wrapping-an-Array:-DiffEqArrayOperator-1" id="Wrapping-an-Array:-DiffEqArrayOperator-1">Wrapping an Array: DiffEqArrayOperator</a></h3><p><code>DiffEqArrayOperator</code> is for defining an operator directly from an array. The operator is of the form</p><div>\[\alpha(t)A(u,p,t)\]</div><p>for some scalar <code>Î±</code> and time plus possibly state dependent <code>A</code>. The constructor is:</p><pre><code class="language-julia">DiffEqArrayOperator(A::AbstractMatrix{T},Î±=1.0,
                             update_func = DEFAULT_UPDATE_FUNC)</code></pre><p><code>A</code> is the operator array. <code>Î±</code> is the scalar coefficient. If <code>Î±</code> is a function <code>Î±(t)</code>, then it will update the coefficient as necessary. <code>update_func(A,u,p,t)</code>  is the function called by <code>update_coefficients!(A,u,p,t)</code> (along with <code>Î±</code> if it's  a function). If left as its default, then <code>update_func</code> is trivial which signifies <code>A</code> is a constant.</p><h3><a class="nav-anchor" href="#AffineDiffEqOperator-1" id="AffineDiffEqOperator-1">AffineDiffEqOperator</a></h3><p>For <code>As = (A1,A2,...,An)</code> and <code>Bs = (B1,B2,...,Bn)</code> where each of the <code>Ai</code> and <code>Bi</code> are <code>DiffEqLinearOperator</code>s, the following constructor:</p><pre><code class="language-julia">function AffineDiffEqOperator{T}(As,Bs,u_cache=nothing)</code></pre><p>builds an operator <code>L = (A1 + A2 + ... An)*u + B1 + B2 + ... + Bn</code>. <code>u_cache</code> is for designating a type of internal cache for non-allocating evaluation of <code>L(du,u,p,t)</code>. If not given, the function <code>L(du,u,p,t)</code> is not available. Note that in solves which exploit this structure, this function call is not necessary. It's only used as the fallback in ODE solvers which were not developed for this structure.</p><h2><a class="nav-anchor" href="#Formal-Properties-of-DiffEqOperators-1" id="Formal-Properties-of-DiffEqOperators-1">Formal Properties of DiffEqOperators</a></h2><p>These are the formal properties that an <code>AbstractDiffEqOperator</code> should obey for it to work in the solvers.</p><h3><a class="nav-anchor" href="#AbstractDiffEqOperator-Interface-Description-1" id="AbstractDiffEqOperator-Interface-Description-1">AbstractDiffEqOperator Interface Description</a></h3><ol><li>Function call and multiplication: <code>L(du,u,p,t)</code> for inplace and <code>du = L(u,p,t)</code> for out-of-place, meaning <code>L*u</code> and <code>mul!</code>.</li><li>If the operator is not a constant, update it with <code>(u,p,t)</code>. A mutating form, i.e. <code>update_coefficients!(A,u,p,t)</code> that changes the internal coefficients, and a out-of-place form <code>B = update_coefficients(A,u,p,t)</code>.</li><li><code>is_constant(A)</code> trait for whether the operator is constant or not.</li></ol><h3><a class="nav-anchor" href="#AbstractDiffEqLinearOpeartor-Interface-Description-1" id="AbstractDiffEqLinearOpeartor-Interface-Description-1">AbstractDiffEqLinearOpeartor Interface Description</a></h3><ol><li><code>AbstractDiffEqLinearOperator &lt;: AbstractDiffEqOperator</code></li><li>Can absorb under multiplication by a scalar. In all algorithms things like <code>dt*L</code> show up all the time, so the linear operator must be able to absorb such constants.</li><li><code>isconstant(A)</code> trait for whether the operator is constant or not.</li><li>Optional: <code>diagonal</code>, <code>symmetric</code>, etc traits from LinearMaps.jl.</li><li>Optional: <code>expm(A)</code>. Required for simple exponential integration.</li><li>Optional: <code>expmv(A,u,t) = expm(t*A)*u</code> and <code>expmv!(v,A::DiffEqOperator,u,t)</code> Required for sparse-saving exponential integration.</li><li>Optional: factorizations. <code>ldiv!</code>, <code>factorize</code> et. al. This is only required for algorithms which use the factorization of the operator (Crank-Nicholson), and only for when the default linear solve is used.</li></ol><footer><hr/><a class="previous" href="../diffeq_arrays/"><span class="direction">Previous</span><span class="title">DiffEq-Specific Array Types</span></a><a class="next" href="../noise_process/"><span class="direction">Next</span><span class="title">Noise Processes</span></a></footer></article></body></HTML>